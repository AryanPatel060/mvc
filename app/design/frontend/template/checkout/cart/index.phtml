<!-- <h1>index</h1> -->
<?php $data = $this->getCartProductData(); ?>
<div class="container mt-5">
    <h2 class="text-center mb-4 fw-bold">ðŸ›’ Shopping Cart</h2>
</div>

<div class="container mt-4">
    <div class="card p-4 shadow-lg border-0">
        <?php foreach ($this->getCartProductData() as $item): ?>
            <?php $product = $item->getProductData(); ?>

            <div class="row border-bottom py-4 px-3 align-items-center cart-item">
                <!-- Product Image -->
                <div class="col-md-3 text-center">
                    <img src="<?php echo $this->getImageUrl($product->getImages()['coverImage']) ?>" 
                         alt="Product Image" class="img-fluid rounded shadow-sm cart-image">
                </div>

                <!-- Product Details -->
                <div class="col-md-6">
                    <h4 class="fw-bold mb-2"><?php echo $product->getName() ?></h4>
                    <p class="text-muted mb-1"><strong>Brand:</strong> <?php echo $product->getBrand() ?></p>
                    <p class="text-muted mb-1"><strong>Material:</strong> <?php echo $product->getMaterial() ?></p>
                    <p class="text-muted mb-1"><strong>Description:</strong> <?php echo $product->getDescription() ?></p>
                    <p class="text-muted mb-3 fw-bold"><strong>Price:</strong> â‚¹<?php echo number_format($product->getPrice(), 2) ?></p>
                </div>

                <!-- Quantity Selector & Actions -->
                <div class="col-md-3 text-center">
                    <div class="d-flex align-items-center justify-content-center">
                        <button class="btn btn-sm btn-outline-primary me-2" onclick="decreaseQuantity(this)">-</button>
                        <input type="text" class="form-control text-center qty-input" 
                               value="<?php echo $item->getProductQuantity(); ?>" readonly>
                        <button class="btn btn-sm btn-outline-primary ms-2" onclick="increaseQuantity(this)">+</button>
                    </div>

                    <div class="mt-3">
                        <h5>Total: <span class="fw-bold total-price">â‚¹<?php echo number_format($item->getSubTotal(), 2) ?></span></h5>
                    </div>

                    <button class="btn btn-danger mt-2 remove-btn" onclick="removeProduct(this)">
                         Remove
                    </button>
                </div>
            </div>

        <?php endforeach; ?>
    </div>
</div>

<style>
    body {
        background-color: #f8f9fa;
    }
    .cart-item:hover {
        background-color: #f1f1f1;
        transition: 0.3s;
    }
    .cart-image {
        max-width: 100%;
        height: auto;
        border-radius: 10px;
    }
    .qty-input {
        width: 50px;
        font-size: 16px;
        font-weight: bold;
    }
    .remove-btn {
        width: 100%;
        font-size: 14px;
    }
</style>

<script>
    function increaseQuantity(button) {
        let qtyInput = $(button).siblings(".qty-input");
        let newQty = parseInt(qtyInput.val()) + 1;
        qtyInput.val(newQty);
        updateTotalPrice(qtyInput, newQty);
    }

    function decreaseQuantity(button) {
        let qtyInput = $(button).siblings(".qty-input");
        let newQty = parseInt(qtyInput.val());
        if (newQty > 1) {
            newQty -= 1;
            qtyInput.val(newQty);
            updateTotalPrice(qtyInput, newQty);
        }
    }

    function updateTotalPrice(qtyInput, qty) {
        let price = parseFloat(qtyInput.closest(".cart-item").find(".fw-bold:eq(3)").text().replace("â‚¹", ""));
        let total = (price * qty).toFixed(2);
        qtyInput.closest(".cart-item").find(".total-price").text(`â‚¹${total}`);
    }

    function removeProduct(button) {
        if (confirm("Are you sure you want to remove this product?")) {
            $(button).closest(".cart-item").fadeOut(300, function() {
                $(this).remove();
            });
        }
    }
</script>
